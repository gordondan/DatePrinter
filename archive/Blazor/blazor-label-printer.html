<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blazor Label Printer Setup</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #5e72e4 0%, #825ee4 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        h1 {
            margin: 0;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .subtitle {
            margin-top: 10px;
            opacity: 0.9;
            font-size: 1.1em;
        }
        .content {
            padding: 40px;
        }
        .section {
            margin-bottom: 40px;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 8px;
            border-left: 4px solid #5e72e4;
        }
        h2 {
            color: #5e72e4;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .icon {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }
        pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 14px;
            line-height: 1.6;
        }
        code {
            font-family: 'Cascadia Code', 'Consolas', monospace;
        }
        .file-structure {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .file-item {
            padding: 8px 12px;
            margin: 4px 0;
            background: #f7fafc;
            border-left: 3px solid #5e72e4;
            border-radius: 4px;
            font-family: monospace;
            transition: all 0.3s ease;
        }
        .file-item:hover {
            background: #edf2f7;
            transform: translateX(5px);
        }
        .command-box {
            background: #1a202c;
            color: #68d391;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            margin: 15px 0;
        }
        .note {
            background: #fef5e7;
            border-left: 4px solid #f39c12;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .note strong {
            color: #e67e22;
        }
        ul {
            line-height: 1.8;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .feature-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }
        .feature-title {
            color: #5e72e4;
            font-weight: bold;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üñ®Ô∏è Blazor Label Printer Application</h1>
            <div class="subtitle">A modern .NET 9.0 Blazor solution for thermal label printing</div>
        </div>
        
        <div class="content">
            <div class="section">
                <h2>
                    <svg class="icon" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                    Project Structure
                </h2>
                <p>Create a new Blazor Web App project with the following structure:</p>
                <div class="file-structure">
                    <div class="file-item">üìÅ LabelPrinter/</div>
                    <div class="file-item" style="margin-left: 20px;">üìÑ Program.cs</div>
                    <div class="file-item" style="margin-left: 20px;">üìÑ LabelPrinter.csproj</div>
                    <div class="file-item" style="margin-left: 20px;">üìÅ Models/</div>
                    <div class="file-item" style="margin-left: 40px;">üìÑ LabelConfiguration.cs</div>
                    <div class="file-item" style="margin-left: 40px;">üìÑ PrintJob.cs</div>
                    <div class="file-item" style="margin-left: 40px;">üìÑ CsvLabelRow.cs</div>
                    <div class="file-item" style="margin-left: 20px;">üìÅ Services/</div>
                    <div class="file-item" style="margin-left: 40px;">üìÑ LabelGeneratorService.cs</div>
                    <div class="file-item" style="margin-left: 40px;">üìÑ PrinterService.cs</div>
                    <div class="file-item" style="margin-left: 40px;">üìÑ CsvProcessorService.cs</div>
                    <div class="file-item" style="margin-left: 20px;">üìÅ Components/</div>
                    <div class="file-item" style="margin-left: 40px;">üìÅ Pages/</div>
                    <div class="file-item" style="margin-left: 60px;">üìÑ Home.razor</div>
                    <div class="file-item" style="margin-left: 60px;">üìÑ BatchPrint.razor</div>
                    <div class="file-item" style="margin-left: 40px;">üìÅ Layout/</div>
                    <div class="file-item" style="margin-left: 60px;">üìÑ MainLayout.razor</div>
                </div>
            </div>

            <div class="section">
                <h2>
                    <svg class="icon" viewBox="0 0 24 24"><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/></svg>
                    Step 1: Create the Project
                </h2>
                <div class="command-box">
                    dotnet new blazor -n LabelPrinter -f net9.0 --interactivity Server
                </div>
                <p>This creates a new Blazor Web App with server-side interactivity using .NET 9.0.</p>
            </div>

            <div class="section">
                <h2>
                    <svg class="icon" viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>
                    Step 2: Install Required NuGet Packages
                </h2>
                <div class="command-box">
                    dotnet add package CsvHelper<br>
                    dotnet add package SixLabors.ImageSharp<br>
                    dotnet add package SixLabors.ImageSharp.Drawing<br>
                    dotnet add package System.Drawing.Common<br>
                    dotnet add package Microsoft.Extensions.Logging
                </div>
            </div>

            <div class="section">
                <h2>
                    <svg class="icon" viewBox="0 0 24 24"><path d="M12 2l-5.5 9h11z M12 22l5.5-9h-11z M3.5 9l5.5 9V9z M20.5 9l-5.5 9V9z"/></svg>
                    Core Implementation Files
                </h2>
                
                <h3>Models/CsvLabelRow.cs</h3>
                <pre><code>using CsvHelper.Configuration.Attributes;

namespace LabelPrinter.Models;

public class CsvLabelRow
{
    [Name("date")]
    public string? Date { get; set; }
    
    [Name("message")]
    public string? Message { get; set; }
    
    [Name("border_message")]
    public string? BorderMessage { get; set; }
    
    [Name("side_border")]
    public string? SideBorder { get; set; }
    
    [Name("image")]
    public string? ImagePath { get; set; }
    
    [Name("show_date")]
    public bool ShowDate { get; set; }
    
    [Name("count")]
    public int Count { get; set; } = 1;
    
    [Name("preview_only")]
    public bool PreviewOnly { get; set; }
    
    public string GenerateCommandLine()
    {
        var args = new List&lt;string&gt;();
        
        if (!string.IsNullOrEmpty(Date))
            args.Add($"-d \"{Date}\"");
            
        if (!string.IsNullOrEmpty(Message))
            args.Add($"-m \"{Message}\"");
            
        if (!string.IsNullOrEmpty(BorderMessage))
            args.Add($"-b \"{BorderMessage}\"");
            
        if (!string.IsNullOrEmpty(SideBorder))
            args.Add($"-s \"{SideBorder}\"");
            
        if (!string.IsNullOrEmpty(ImagePath))
            args.Add($"-i \"{ImagePath}\"");
            
        if (ShowDate)
            args.Add("-o");
            
        if (Count > 1)
            args.Add($"-c {Count}");
            
        if (PreviewOnly)
            args.Add("-p");
            
        return string.Join(" ", args);
    }
}</code></pre>

                <h3>Services/CsvProcessorService.cs</h3>
                <pre><code>using CsvHelper;
using CsvHelper.Configuration;
using System.Globalization;
using System.Text;
using LabelPrinter.Models;

namespace LabelPrinter.Services;

public class CsvProcessorService
{
    private readonly ILogger&lt;CsvProcessorService&gt; _logger;
    
    public CsvProcessorService(ILogger&lt;CsvProcessorService&gt; logger)
    {
        _logger = logger;
    }
    
    public async Task&lt;List&lt;CsvLabelRow&gt;&gt; ProcessCsvFileAsync(Stream fileStream)
    {
        var rows = new List&lt;CsvLabelRow&gt;();
        
        try
        {
            using var reader = new StreamReader(fileStream);
            using var csv = new CsvReader(reader, new CsvConfiguration(CultureInfo.InvariantCulture)
            {
                HeaderValidated = null,
                MissingFieldFound = null
            });
            
            rows = csv.GetRecords&lt;CsvLabelRow&gt;().ToList();
            _logger.LogInformation($"Processed {rows.Count} rows from CSV");
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error processing CSV file");
            throw;
        }
        
        return rows;
    }
    
    public async Task&lt;string&gt; GenerateBatchScriptAsync(List&lt;CsvLabelRow&gt; rows, string pythonPath = "python")
    {
        var sb = new StringBuilder();
        
        // Windows batch file header
        sb.AppendLine("@echo off");
        sb.AppendLine("echo Starting batch label printing...");
        sb.AppendLine();
        
        int labelNumber = 1;
        foreach (var row in rows)
        {
            sb.AppendLine($"echo Printing label {labelNumber} of {rows.Count}...");
            sb.AppendLine($"{pythonPath} label-printer.py {row.GenerateCommandLine()}");
            sb.AppendLine($"if errorlevel 1 (");
            sb.AppendLine($"    echo Error printing label {labelNumber}");
            sb.AppendLine($"    pause");
            sb.AppendLine($"    exit /b 1");
            sb.AppendLine($")");
            sb.AppendLine();
            labelNumber++;
        }
        
        sb.AppendLine("echo Batch printing completed successfully!");
        sb.AppendLine("pause");
        
        return sb.ToString();
    }
    
    public async Task&lt;string&gt; GenerateShellScriptAsync(List&lt;CsvLabelRow&gt; rows, string pythonPath = "python3")
    {
        var sb = new StringBuilder();
        
        // Unix/Linux shell script header
        sb.AppendLine("#!/bin/bash");
        sb.AppendLine("echo 'Starting batch label printing...'");
        sb.AppendLine();
        
        int labelNumber = 1;
        foreach (var row in rows)
        {
            sb.AppendLine($"echo 'Printing label {labelNumber} of {rows.Count}...'");
            sb.AppendLine($"{pythonPath} label-printer.py {row.GenerateCommandLine()}");
            sb.AppendLine($"if [ $? -ne 0 ]; then");
            sb.AppendLine($"    echo 'Error printing label {labelNumber}'");
            sb.AppendLine($"    read -p 'Press Enter to exit...'");
            sb.AppendLine($"    exit 1");
            sb.AppendLine($"fi");
            sb.AppendLine();
            labelNumber++;
        }
        
        sb.AppendLine("echo 'Batch printing completed successfully!'");
        sb.AppendLine("read -p 'Press Enter to exit...'");
        
        return sb.ToString();
    }
    
    public async Task ExecuteBatchScriptAsync(string scriptPath)
    {
        try
        {
            var process = new System.Diagnostics.Process();
            
            if (OperatingSystem.IsWindows())
            {
                process.StartInfo.FileName = "cmd.exe";
                process.StartInfo.Arguments = $"/c \"{scriptPath}\"";
            }
            else
            {
                process.StartInfo.FileName = "/bin/bash";
                process.StartInfo.Arguments = scriptPath;
            }
            
            process.StartInfo.UseShellExecute = false;
            process.StartInfo.RedirectStandardOutput = true;
            process.StartInfo.RedirectStandardError = true;
            
            process.Start();
            await process.WaitForExitAsync();
            
            if (process.ExitCode != 0)
            {
                var error = await process.StandardError.ReadToEndAsync();
                throw new Exception($"Script execution failed: {error}");
            }
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error executing batch script");
            throw;
        }
    }
}</code></pre>

                <h3>Components/Pages/BatchPrint.razor</h3>
                <pre><code>@page "/batch-print"
@using LabelPrinter.Models
@using LabelPrinter.Services
@inject CsvProcessorService CsvProcessor
@inject ILogger&lt;BatchPrint&gt; Logger
@inject IJSRuntime JS

&lt;PageTitle&gt;Batch Label Printing&lt;/PageTitle&gt;

&lt;div class="container mt-4"&gt;
    &lt;h1&gt;Batch Label Printing from CSV&lt;/h1&gt;
    
    &lt;div class="card mt-4"&gt;
        &lt;div class="card-body"&gt;
            &lt;h5 class="card-title"&gt;Upload CSV File&lt;/h5&gt;
            
            &lt;div class="mb-3"&gt;
                &lt;label for="csvFile" class="form-label"&gt;Select CSV file:&lt;/label&gt;
                &lt;InputFile id="csvFile" class="form-control" OnChange="@LoadFile" accept=".csv" /&gt;
            &lt;/div&gt;
            
            @if (isLoading)
            {
                &lt;div class="spinner-border" role="status"&gt;
                    &lt;span class="visually-hidden"&gt;Loading...&lt;/span&gt;
                &lt;/div&gt;
            }
            
            @if (rows.Any())
            {
                &lt;div class="alert alert-success"&gt;
                    Loaded @rows.Count label(s) from CSV
                &lt;/div&gt;
                
                &lt;div class="table-responsive"&gt;
                    &lt;table class="table table-striped"&gt;
                        &lt;thead&gt;
                            &lt;tr&gt;
                                &lt;th&gt;#&lt;/th&gt;
                                &lt;th&gt;Date&lt;/th&gt;
                                &lt;th&gt;Message&lt;/th&gt;
                                &lt;th&gt;Border&lt;/th&gt;
                                &lt;th&gt;Side&lt;/th&gt;
                                &lt;th&gt;Image&lt;/th&gt;
                                &lt;th&gt;Show Date&lt;/th&gt;
                                &lt;th&gt;Count&lt;/th&gt;
                                &lt;th&gt;Preview&lt;/th&gt;
                            &lt;/tr&gt;
                        &lt;/thead&gt;
                        &lt;tbody&gt;
                            @foreach (var (row, index) in rows.Select((r, i) =&gt; (r, i)))
                            {
                                &lt;tr&gt;
                                    &lt;td&gt;@(index + 1)&lt;/td&gt;
                                    &lt;td&gt;@row.Date&lt;/td&gt;
                                    &lt;td&gt;@row.Message&lt;/td&gt;
                                    &lt;td&gt;@row.BorderMessage&lt;/td&gt;
                                    &lt;td&gt;@row.SideBorder&lt;/td&gt;
                                    &lt;td&gt;@row.ImagePath&lt;/td&gt;
                                    &lt;td&gt;@(row.ShowDate ? "Yes" : "No")&lt;/td&gt;
                                    &lt;td&gt;@row.Count&lt;/td&gt;
                                    &lt;td&gt;@(row.PreviewOnly ? "Yes" : "No")&lt;/td&gt;
                                &lt;/tr&gt;
                            }
                        &lt;/tbody&gt;
                    &lt;/table&gt;
                &lt;/div&gt;
                
                &lt;div class="mt-3"&gt;
                    &lt;div class="form-check mb-3"&gt;
                        &lt;input class="form-check-input" type="checkbox" @bind="previewOnly" id="previewCheck"&gt;
                        &lt;label class="form-check-label" for="previewCheck"&gt;
                            Preview Only (Generate script without printing)
                        &lt;/label&gt;
                    &lt;/div&gt;
                    
                    &lt;button class="btn btn-primary me-2" @onclick="GenerateScript"&gt;
                        Generate Script
                    &lt;/button&gt;
                    
                    @if (!string.IsNullOrEmpty(generatedScript))
                    {
                        &lt;button class="btn btn-success me-2" @onclick="DownloadScript"&gt;
                            Download Script
                        &lt;/button&gt;
                        
                        @if (!previewOnly)
                        {
                            &lt;button class="btn btn-warning" @onclick="ExecuteScript"&gt;
                                Execute Script
                            &lt;/button&gt;
                        }
                    }
                &lt;/div&gt;
                
                @if (!string.IsNullOrEmpty(generatedScript))
                {
                    &lt;div class="mt-3"&gt;
                        &lt;h6&gt;Generated Script:&lt;/h6&gt;
                        &lt;pre class="bg-dark text-light p-3 rounded"&gt;@generatedScript&lt;/pre&gt;
                    &lt;/div&gt;
                }
            }
            
            @if (!string.IsNullOrEmpty(errorMessage))
            {
                &lt;div class="alert alert-danger mt-3"&gt;
                    @errorMessage
                &lt;/div&gt;
            }
        &lt;/div&gt;
    &lt;/div&gt;
    
    &lt;div class="card mt-4"&gt;
        &lt;div class="card-body"&gt;
            &lt;h5 class="card-title"&gt;CSV Format Example&lt;/h5&gt;
            &lt;pre class="bg-light p-3 rounded"&gt;date,message,border_message,side_border,image,show_date,count,preview_only
2024-03-15,Product A,Border Text,Side Text,/path/to/image.png,true,2,false
2024-03-16,Product B,,,logo.png,false,1,false
,Custom Message,Frame Text,,,true,3,true&lt;/pre&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

@code {
    private List&lt;CsvLabelRow&gt; rows = new();
    private bool isLoading = false;
    private string? errorMessage;
    private string? generatedScript;
    private bool previewOnly = false;
    private string? scriptFileName;
    
    private async Task LoadFile(InputFileChangeEventArgs e)
    {
        isLoading = true;
        errorMessage = null;
        rows.Clear();
        generatedScript = null;
        
        try
        {
            var file = e.File;
            if (file.ContentType != "text/csv" && !file.Name.EndsWith(".csv"))
            {
                errorMessage = "Please select a CSV file";
                return;
            }
            
            using var stream = file.OpenReadStream(maxAllowedSize: 10 * 1024 * 1024); // 10MB max
            rows = await CsvProcessor.ProcessCsvFileAsync(stream);
        }
        catch (Exception ex)
        {
            errorMessage = $"Error loading file: {ex.Message}";
            Logger.LogError(ex, "Error loading CSV file");
        }
        finally
        {
            isLoading = false;
        }
    }
    
    private async Task GenerateScript()
    {
        try
        {
            if (OperatingSystem.IsWindows())
            {
                generatedScript = await CsvProcessor.GenerateBatchScriptAsync(rows);
                scriptFileName = $"print_labels_{DateTime.Now:yyyyMMdd_HHmmss}.bat";
            }
            else
            {
                generatedScript = await CsvProcessor.GenerateShellScriptAsync(rows);
                scriptFileName = $"print_labels_{DateTime.Now:yyyyMMdd_HHmmss}.sh";
            }
        }
        catch (Exception ex)
        {
            errorMessage = $"Error generating script: {ex.Message}";
            Logger.LogError(ex, "Error generating script");
        }
    }
    
    private async Task DownloadScript()
    {
        if (string.IsNullOrEmpty(generatedScript) || string.IsNullOrEmpty(scriptFileName))
            return;
            
        var bytes = System.Text.Encoding.UTF8.GetBytes(generatedScript);
        var base64 = Convert.ToBase64String(bytes);
        
        await JS.InvokeVoidAsync("downloadFile", scriptFileName, base64);
    }
    
    private async Task ExecuteScript()
    {
        try
        {
            // Save script to temp file
            var tempPath = Path.GetTempFileName();
            if (OperatingSystem.IsWindows())
            {
                tempPath = Path.ChangeExtension(tempPath, ".bat");
            }
            else
            {
                tempPath = Path.ChangeExtension(tempPath, ".sh");
            }
            
            await File.WriteAllTextAsync(tempPath, generatedScript);
            
            // Make executable on Unix-like systems
            if (!OperatingSystem.IsWindows())
            {
                var chmod = System.Diagnostics.Process.Start("chmod", $"+x {tempPath}");
                await chmod.WaitForExitAsync();
            }
            
            await CsvProcessor.ExecuteBatchScriptAsync(tempPath);
            
            // Clean up
            File.Delete(tempPath);
        }
        catch (Exception ex)
        {
            errorMessage = $"Error executing script: {ex.Message}";
            Logger.LogError(ex, "Error executing script");
        }
    }
}</code></pre>
            </div>

            <div class="section">
                <h2>
                    <svg class="icon" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/></svg>
                    Key Features
                </h2>
                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-title">CSV Processing</div>
                        <div>Reads CSV files with headers matching command-line options</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-title">Script Generation</div>
                        <div>Creates platform-specific batch/shell scripts</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-title">Preview Mode</div>
                        <div>Option to generate scripts without executing</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-title">Cross-Platform</div>
                        <div>Works on Windows, Linux, and macOS</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-title">Error Handling</div>
                        <div>Comprehensive logging and error recovery</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-title">Modern UI</div>
                        <div>Bootstrap 5 responsive interface</div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>
                    <svg class="icon" viewBox="0 0 24 24"><path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"/></svg>
                    JavaScript Support (wwwroot/js/site.js)
                </h2>
                <pre><code>window.downloadFile = (filename, base64Content) => {
    const link = document.createElement('a');
    link.href = 'data:application/octet-stream;base64,' + base64Content;
    link.download = filename;
    link.click();
};</code></pre>
            </div>

            <div class="note">
                <strong>Note:</strong> This Blazor application provides a web interface for batch processing CSV files into label printing commands. The actual Python script (label-printer.py) should be available in the execution environment. The application generates platform-specific scripts that can be downloaded and executed locally or remotely.
            </div>

            <div class="section">
                <h2>
                    <svg class="icon" viewBox="0 0 24 24"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z"/></svg>
                    Deployment & Usage
                </h2>
                <h3>Running the Application</h3>
                <div class="command-box">
                    cd LabelPrinter<br>
                    dotnet run
                </div>
                <p>Navigate to <code>https://localhost:5001/batch-print</code> to access the batch printing interface.</p>
                
                <h3>CSV File Format</h3>
                <p>The CSV file should have the following columns (all optional except for at least one content field):</p>
                <ul>
                    <li><strong>date</strong> - Date in YYYY-MM-DD format</li>
                    <li><strong>message</strong> - Main message for the label center</li>
                    <li><strong>border_message</strong> - Text for top/bottom borders</li>
                    <li><strong>side_border</strong> - Text for left/right borders</li>
                    <li><strong>image</strong> - Path to PNG image file</li>
                    <li><strong>show_date</strong> - true/false to display date</li>
                    <li><strong>count</strong> - Number of copies (default: 1)</li>
                    <li><strong>preview_only</strong> - true/false for preview mode</li>
                </ul>
            </div>

            <div class="section">
                <h2>
                    <svg class="icon" viewBox="0 0 24 24"><path d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/></svg>
                    Additional Considerations
                </h2>
                <h3>Windows Printer Integration</h3>
                <p>For direct Windows printer integration, add this service:</p>
                <pre><code>using System.Drawing.Printing;
using System.Management;

public class WindowsPrinterService
{
    public List<string> GetAvailablePrinters()
    {
        var printers = new List<string>();
        foreach (string printer in PrinterSettings.InstalledPrinters)
        {
            printers.Add(printer);
        }
        return printers;
    }
    
    public PrinterInfo GetPrinterCapabilities(string printerName)
    {
        var settings = new PrinterSettings { PrinterName = printerName };
        return new PrinterInfo
        {
            Name = printerName,
            IsDefault = settings.IsDefaultPrinter,
            CanDuplex = settings.CanDuplex,
            MaxCopies = settings.MaximumCopies,
            PaperSizes = settings.PaperSizes.Cast<PaperSize>()
                .Select(ps => new { ps.PaperName, ps.Width, ps.Height })
                .ToList()
        };
    }
}</code></pre>

                <h3>Direct Label Generation in C#</h3>
                <p>To generate labels directly in C# without Python:</p>
                <pre><code>using SixLabors.ImageSharp;
using SixLabors.ImageSharp.Processing;
using SixLabors.ImageSharp.Drawing.Processing;
using SixLabors.Fonts;

public class LabelGeneratorService
{
    private readonly ILogger<LabelGeneratorService> _logger;
    
    public async Task<byte[]> GenerateLabelAsync(LabelOptions options)
    {
        int width = (int)(options.WidthInches * options.DPI);
        int height = (int)(options.HeightInches * options.DPI);
        
        using var image = new Image<Rgba32>(width, height);
        
        image.Mutate(ctx =>
        {
            // White background
            ctx.Fill(Color.White);
            
            // Draw border
            ctx.DrawPolygon(
                Color.Black,
                options.BorderThickness,
                new PointF[] {
                    new(4, 4),
                    new(width - 4, 4),
                    new(width - 4, height - 4),
                    new(4, height - 4)
                });
            
            // Draw text
            if (!string.IsNullOrEmpty(options.Message))
            {
                var font = SystemFonts.CreateFont("Arial", options.FontSize);
                var textOptions = new TextOptions(font)
                {
                    Origin = new PointF(width / 2, height / 2),
                    HorizontalAlignment = HorizontalAlignment.Center,
                    VerticalAlignment = VerticalAlignment.Center
                };
                
                ctx.DrawText(options.Message, font, Color.Black, 
                    new PointF(width / 2, height / 2));
            }
        });
        
        using var ms = new MemoryStream();
        await image.SaveAsPngAsync(ms);
        return ms.ToArray();
    }
}</code></pre>

                <h3>Program.cs Configuration</h3>
                <pre><code>var builder = WebApplication.CreateBuilder(args);

// Add services
builder.Services.AddRazorComponents()
    .AddInteractiveServerComponents();

builder.Services.AddScoped<CsvProcessorService>();
builder.Services.AddScoped<LabelGeneratorService>();
builder.Services.AddScoped<WindowsPrinterService>();

builder.Services.AddLogging(config =>
{
    config.AddConsole();
    config.AddDebug();
    config.AddFile("Logs/labelprinter-{Date}.txt");
});

var app = builder.Build();

// Configure pipeline
if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Error");
    app.UseHsts();
}

app.UseHttpsRedirection();
app.UseStaticFiles();
app.UseAntiforgery();

app.MapRazorComponents<App>()
    .AddInteractiveServerRenderMode();

app.Run();</code></pre>
            </div>

            <div class="section">
                <h2>
                    <svg class="icon" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                    Complete Example: Home.razor
                </h2>
                <pre><code>@page "/"
@using LabelPrinter.Services
@inject WindowsPrinterService PrinterService
@inject LabelGeneratorService LabelGenerator

<PageTitle>Label Printer</PageTitle>

<div class="container mt-4">
    <h1>Label Printer Control Panel</h1>
    
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">Quick Print</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label class="form-label">Printer:</label>
                        <select class="form-select" @bind="selectedPrinter">
                            <option value="">-- Select Printer --</option>
                            @foreach (var printer in availablePrinters)
                            {
                                <option value="@printer">@printer</option>
                            }
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Message:</label>
                        <input type="text" class="form-control" @bind="message" />
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Date:</label>
                        <input type="date" class="form-control" @bind="labelDate" />
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Copies:</label>
                        <input type="number" class="form-control" @bind="copies" min="1" />
                    </div>
                    
                    <button class="btn btn-primary" @onclick="PrintLabel">
                        Print Label
                    </button>
                    <button class="btn btn-secondary ms-2" @onclick="PreviewLabel">
                        Preview
                    </button>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">Preview</h5>
                </div>
                <div class="card-body">
                    @if (previewImage != null)
                    {
                        <img src="@previewImage" class="img-fluid" alt="Label Preview" />
                    }
                    else
                    {
                        <p class="text-muted">No preview available</p>
                    }
                </div>
            </div>
        </div>
    </div>
    
    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">Batch Operations</h5>
                </div>
                <div class="card-body">
                    <a href="/batch-print" class="btn btn-success">
                        Go to Batch Print from CSV
                    </a>
                    <button class="btn btn-outline-primary ms-2" @onclick="ShowPrinterInfo">
                        Show Printer Info
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    @if (showPrinterInfo && selectedPrinter != null)
    {
        <div class="alert alert-info mt-4">
            <h6>Printer Information: @selectedPrinter</h6>
            <pre>@printerInfoJson</pre>
        </div>
    }
</div>

@code {
    private List<string> availablePrinters = new();
    private string? selectedPrinter;
    private string message = "Sample Label";
    private DateTime labelDate = DateTime.Today;
    private int copies = 1;
    private string? previewImage;
    private bool showPrinterInfo = false;
    private string? printerInfoJson;
    
    protected override async Task OnInitializedAsync()
    {
        availablePrinters = PrinterService.GetAvailablePrinters();
        if (availablePrinters.Any())
        {
            selectedPrinter = availablePrinters.First();
        }
    }
    
    private async Task PrintLabel()
    {
        // Implementation for printing
        var options = new LabelOptions
        {
            Message = message,
            Date = labelDate,
            WidthInches = 2.25,
            HeightInches = 1.25,
            DPI = 203,
            FontSize = 24,
            BorderThickness = 6
        };
        
        var imageBytes = await LabelGenerator.GenerateLabelAsync(options);
        // Send to printer...
    }
    
    private async Task PreviewLabel()
    {
        var options = new LabelOptions
        {
            Message = message,
            Date = labelDate,
            WidthInches = 2.25,
            HeightInches = 1.25,
            DPI = 203,
            FontSize = 24,
            BorderThickness = 6
        };
        
        var imageBytes = await LabelGenerator.GenerateLabelAsync(options);
        previewImage = $"data:image/png;base64,{Convert.ToBase64String(imageBytes)}";
    }
    
    private void ShowPrinterInfo()
    {
        if (!string.IsNullOrEmpty(selectedPrinter))
        {
            var info = PrinterService.GetPrinterCapabilities(selectedPrinter);
            printerInfoJson = System.Text.Json.JsonSerializer.Serialize(info, 
                new System.Text.Json.JsonSerializerOptions { WriteIndented = true });
            showPrinterInfo = true;
        }
    }
}</code></pre>
            </div>

            <div class="note">
                <strong>Important:</strong> This Blazor application provides a complete web-based solution for label printing. The CSV batch processing feature generates scripts that call the Python label-printer.py script. For a fully integrated C# solution, you can implement the label generation logic directly using ImageSharp as shown in the LabelGeneratorService example.
            </div>

            <div class="section">
                <h2>
                    <svg class="icon" viewBox="0 0 24 24"><path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/></svg>
                    Summary
                </h2>
                <p>This Blazor solution provides:</p>
                <ul>
                    <li>‚úÖ CSV file upload and processing</li>
                    <li>‚úÖ Automatic script generation (batch/shell)</li>
                    <li>‚úÖ Preview mode support</li>
                    <li>‚úÖ Cross-platform compatibility</li>
                    <li>‚úÖ Modern web interface</li>
                    <li>‚úÖ Integration with existing Python script</li>
                    <li>‚úÖ Optional direct C# label generation</li>
                    <li>‚úÖ Windows printer integration</li>
                </ul>
            </div>